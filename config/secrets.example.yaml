# =============================================================================
# IcePorge Secrets Configuration
# =============================================================================
# This file contains sensitive values that should be masked in GitHub pushes.
# The sync-to-github.sh script will replace these values with placeholders
# in any files being pushed to GitHub.
#
# IMPORTANT:
# 1. Copy this file to secrets.yaml
# 2. Replace the example values with your actual API keys
# 3. This file (secrets.yaml) should NEVER be committed to GitHub!
# =============================================================================

# Secrets to mask when pushing to GitHub
# Format: Each entry will be replaced with a placeholder like <MASKED_VIRUSTOTAL_KEY>
secrets:
  # Example: VirusTotal API Key
  - name: "VIRUSTOTAL_KEY"
    value: "your-virustotal-api-key-here"
    description: "VirusTotal API Key"
    rotate_url: "https://www.virustotal.com/gui/user/apikey"
    config_location: "/path/to/config/config.yaml"

  # Example: AbuseIPDB API Key
  - name: "ABUSEIPDB_KEY"
    value: "your-abuseipdb-api-key-here"
    description: "AbuseIPDB API Key"
    rotate_url: "https://www.abuseipdb.com/account/api"
    config_location: "/path/to/config/config.yaml"

  # Example: GitHub Personal Access Token
  - name: "GITHUB_PAT"
    value: "github_pat_your_token_here"
    description: "GitHub Personal Access Token"
    rotate_url: "https://github.com/settings/tokens"
    config_location: "Environment/Cron"

# Patterns to detect (in addition to TruffleHog)
# These are regex patterns for additional custom secrets
patterns:
  - name: "Internal IP"
    pattern: '\b10\.\d{1,3}\.\d{1,3}\.\d{1,3}\b'
    action: "warn"  # warn or mask

  - name: "Private Email"
    pattern: '[a-zA-Z0-9._%+-]+@(?!your-domain\.com)[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}'
    action: "warn"

# Allowed patterns (whitelist - these will NOT be flagged)
allowed:
  - "info@your-domain.com"
  - "127.0.0.1"
  - "localhost"
